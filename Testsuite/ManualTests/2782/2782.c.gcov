        -:    0:Source:2782.c
        -:    0:Graph:2782.gcno
        -:    0:Data:2782.gcda
        -:    0:Runs:1
        -:    1:/* Test that the compiler properly optimizes floating point multiply and add
        -:    2:   instructions vector into pmacsdd/etc. on XOP systems.  */
        -:    3:
        -:    4:/* { dg-do compile } */
        -:    5:/* { dg-require-effective-target lp64 } */
        -:    6:/* { dg-options "-O2 -mxop -mno-avx2 -ftree-vectorize" } */
        -:    7:
        -:    8:extern void exit(int);
        -:    9:
        -:   10:typedef long __m128i __attribute__((__vector_size__(16), __may_alias__));
        -:   11:
        -:   12:#define SIZE 10240
        -:   13:
        -:   14:union {
        -:   15:  __m128i i_align;
        -:   16:  int i32[SIZE];
        -:   17:  long i64[SIZE];
        -:   18:} a, b, c, d;
        -:   19:
        1:   20:void imul32_to_64(void) {
        -:   21:  int i;
        -:   22:
    10241:   23:  for (i = 0; i < SIZE; i++)
    10240:   24:    a.i64[i] = ((long)b.i32[i]) * ((long)c.i32[i]);
        1:   25:}
        -:   26:
        1:   27:int main() {
        1:   28:  imul32_to_64();
        1:   29:  exit(0);
        -:   30:}
        -:   31:
        -:   32:/* { dg-final { scan-assembler "vpmuldq" } } */
        -:   33:/* { dg-final { scan-assembler "vpmacsdqh" } } */
