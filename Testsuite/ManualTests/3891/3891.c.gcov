        -:    0:Source:3891.c
        -:    0:Graph:3891.gcno
        -:    0:Data:3891.gcda
        -:    0:Runs:1
        -:    1:long (*extfunc)();
        -:    2:
        1:    3:static inline void lstrcpynW(short *d, const short *s, int n) {
        1:    4:  unsigned int count = n;
        -:    5:
        5:    6:  while ((count > 1) && *s) {
        4:    7:    count--;
        4:    8:    *d++ = *s++;
        -:    9:  }
        1:   10:  if (count)
        1:   11:    *d = 0;
        1:   12:}
        -:   13:
        -:   14:int __attribute__((noinline, noclone))
        1:   15:badfunc(int u0, int u1, int u2, int u3, short *fsname,
        -:   16:        unsigned int fsname_len) {
        -:   17:  static const short ntfsW[] = {'N', 'T', 'F', 'S', 0};
        -:   18:  char superblock[2048 + 3300];
        1:   19:  int ret = 0;
        -:   20:  short *p;
        -:   21:
        1:   22:  if (extfunc())
    #####:   23:    return 0;
        1:   24:  p = (void *)extfunc();
        1:   25:  if (p != 0)
    #####:   26:    goto done;
        -:   27:
        1:   28:  extfunc(superblock);
        -:   29:
        1:   30:  lstrcpynW(fsname, ntfsW, fsname_len);
        -:   31:
        1:   32:  ret = 1;
        1:   33:done:
        1:   34:  return ret;
        -:   35:}
        -:   36:
        3:   37:static long f() { return 0; }
        -:   38:
        1:   39:int main() {
        -:   40:  short buf[6];
        1:   41:  extfunc = f;
        1:   42:  return !badfunc(0, 0, 0, 0, buf, 6);
        -:   43:}
