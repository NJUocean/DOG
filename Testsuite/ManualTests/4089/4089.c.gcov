        -:    0:Source:4089.c
        -:    0:Graph:4089.gcno
        -:    0:Data:4089.gcda
        -:    0:Runs:1
        -:    1:/* Copyright (C) 2003  Free Software Foundation.
        -:    2:
        -:    3:   Test strcpy optimizations don't evaluate side-effects twice.
        -:    4:
        -:    5:   Written by Jakub Jelinek, June 23, 2003.  */
        -:    6:
        -:    7:typedef __SIZE_TYPE__ size_t;
        -:    8:extern char *strcpy(char *, const char *);
        -:    9:extern int memcmp(const void *, const void *, size_t);
        -:   10:extern void abort(void);
        -:   11:extern void exit(int);
        -:   12:
        1:   13:size_t test1(char *s, size_t i) {
        1:   14:  strcpy(s, "foobarbaz" + i++);
        1:   15:  return i;
        -:   16:}
        -:   17:
        1:   18:size_t check2(void) {
        -:   19:  static size_t r = 5;
        1:   20:  if (r != 5)
    #####:   21:    abort();
        1:   22:  return ++r;
        -:   23:}
        -:   24:
        1:   25:void test2(char *s) { strcpy(s, "foobarbaz" + check2()); }
        -:   26:
        1:   27:int main(void) {
        -:   28:  char buf[10];
        1:   29:  if (test1(buf, 7) != 8 || memcmp(buf, "az", 3))
    #####:   30:    abort();
        1:   31:  test2(buf);
        1:   32:  if (memcmp(buf, "baz", 4))
    #####:   33:    abort();
        1:   34:  exit(0);
        -:   35:}
